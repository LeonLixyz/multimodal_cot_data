{
  "prompt_template": "You are an expert in creating clean multimodal chain of thought traces. Your task is to first analyze a raw and noisy reasoning trace along with associated images, and then generate a clean, structured, step-by-step multimodal reasoning trace that solves the original problem.\n\n**Input Data Provided to You:**\nThe input data has the following components:\n\n- Problem & Noisy Trace Context: A pdf file with a noisy or raw interleaved text and image reasoning trace. The problem might have image or not. The reasoning trace has image.\n\n**Your Task:** Generate a *new*, clean JSON output trace that represents the *ideal* multimodal reasoning process to solve the problem, using the provided context and images for understanding. Ensure the reasoning is logically coherent and clearly explained.\n\n**Output Format (Clean Trace with Placeholders):**\nYou MUST generate a valid JSON array adhering strictly to the following structure. Use the specified placeholders for images:\n[\n{\n\"role\": \"user\",\n\"content\": [\n{\n\"type\": \"text\",\n\"text\": \"The original problem statement\"\n},\n{\n\"type\": \"image_url\",\n\"image_url\": {\n\"url\": \"[input_image]\" // use this placeholder for the input image The problem might also not have an input image, in that case, ignore.\n}\n}\n]\n},\n{\n\"role\": \"assistant\",\n\"content\": [\n{\n\"type\": \"text\",\n\"text\": \"THOUGHT 0: <Clear description of initial reasoning step, also explaining why an image will be created to help with >\"\n},\n{\n\"type\": \"text\",\n\"text\": \"THOUGHT 1: <Clear description of the next reasoning step, often explaining why an image will be created>\"\n},\n{\n\"type\": \"image_url\",\n\"image_url\": {\n\"url\": \"[intermediate_image_1]\" // use this placeholder for subsequent intermediate images.\n}\n},\n// ... Add more text thoughts and image placeholders as needed for logical flow ...\n{\n\"type\": \"image_url\",\n\"image_url\": {\n\"url\": \"[intermediate_image_X]\" // Placeholder for subsequent intermediate images\n}\n},\n{\n\"type\": \"text\",\n\"text\": \"THOUGHT N: <Description of the final reasoning step before the answer>\"\n},\n{\n\"type\": \"text\",\n\"text\": \"ANSWER: <The final calculated answer based on the reasoning>\"\n}\n]\n}\n]\n\n**Key Guidelines for Generation:**\n\n1. Generate Coherent Reasoning: Focus on creating a logically sound step-by-step thought process that correctly solves the problem, using the provided images and context trace for understanding.\n2. Use Placeholders for Images: Represent **all** images in the generated JSON using placeholders: `[input_image]` for the initial problem image (if it has an initial image) and `[intermediate_image_X]` (e.g., `[intermediate_image_1]`, `[intermediate_image_2]`) for images generated during the reasoning process.\n3. The problem might contain image or not. If the problem does not contain image, ignore `[input_image]`\n4. Avoid including noise from the original trace (code, errors, verbose observations) unless mentioning a concept from it is essential for the clean reasoning.\n5. Keep the original problem statement and initial image\n6. Keep the original auxiliary images in the raw reasoning trace\n7. Maintain the logical flow and numbered thought sequence\n\nParse all the question and responses here:\n\n**Output Format (Clean Trace with Placeholders):**\nYou MUST generate a valid JSON array adhering strictly to the following structure. Use the specified placeholders for images:\n[\n{\n\"role\": \"user\",\n\"content\": [\n{\n\"type\": \"text\",\n\"text\": \"The original problem statement\"\n},\n{\n\"type\": \"image_url\",\n\"image_url\": {\n\"url\": \"[input_image]\" // use this placeholder for the input image The problem might also not have an input image, in that case, ignore.\n}\n}\n]\n},\n{\n\"role\": \"assistant\",\n\"content\": [\n{\n\"type\": \"text\",\n\"text\": \"<Reasoning steps in text>\"\n},\n{\n\"type\": \"image_url\",\n\"image_url\": {\n\"url\": \"[intermediate_image_1]\" // use this placeholder for subsequent intermediate images.\n}\n},\n// ... Add more text thoughts and image placeholders as needed for logical flow ...\n{\n\"type\": \"image_url\",\n\"image_url\": {\n\"url\": \"[intermediate_image_X]\" // Placeholder for subsequent intermediate images\n}\n},\n{\n\"type\": \"text\",\n\"text\": \"<Description of the final reasoning step before the answer>\"\n},\n{\n\"type\": \"text\",\n\"text\": \"ANSWER: <The final calculated answer based on the reasoning>\"\n}\n]\n}\n]"
}